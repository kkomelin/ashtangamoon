<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <style>
      html, body {
        margin:0;padding:0;
      }
      #root {
        position: relative;
        border: 1px solid gray;
        background: black;
      }
    </style>
  </head>
  <body>
    <svg id="root" />

    <script src="./src/index.js"></script>

    <script src='https://d3js.org/d3.v5.min.js'></script>

    <script>
      function toProxyX(initPos, radius, phase) {
        // 0	New Moon = all black
        // 0.25	First Quarter
        // 0.5	Full Moon = all white
        // 0.75	Last Quarter

        const diameter = radius * 2;
        const sub = (phase > 0 && phase <= 0.5) ? 0 : diameter;

        return initPos + radius * 2 * phase - sub;
      }

      (function draw() {
        const width = 300;
        const height = 300;
        const moonRadius = 50;
        const phase = 0.9471420111907518;

        const root = d3.select("#root")
          .attr("width", width)
          .attr("height", height)
          .append("g")
          .attr("id", "root-view");

        // The main visible moon.
        const main = root
          .append("circle")
          .attr("id", "moon")
          .attr("cx", width / 2)
          .attr("cy", height / 2)
          .attr("r", moonRadius)
          .style("fill", "white");

        const initial_pos = width / 2;
        const proxyPosX = toProxyX(initial_pos, moonRadius, phase)

        // The proxy moon which overlaps the main one.
        const proxy = root
          .append("circle")
          .attr("id", "proxy-moon")
          .attr("cx", proxyPosX)
          .attr("cy", height / 2)
          .attr("r", moonRadius)
          .style("fill", "black");


          // <rect x="0" y="0" width="50" height="50" fill="green" />
      })();
    </script>
  </body>
</html>
